# DeepSeek AI 助手集成 - 使用说明

## 功能概述

已成功为远程服务器管理器集成 DeepSeek AI 助手，提供智能命令行辅助功能！

### 核心功能

1. **🤖 命令生成**
   - 用自然语言描述需求，AI 自动生成 Shell 命令
   - 示例："查找并删除3天前的日志文件" → `find /var/log -name "*.log" -mtime +3 -exec rm {} \;`

2. **📚 命令解释**
   - 解释任意 Shell 命令的作用和参数
   - 分析命令输出（stdout/stderr），提供错误诊断

3. **⚡ 流式响应**
   - 实时打字机效果，边生成边显示
   - 无需等待完整响应

4. **💡 智能提示**
   - 提供常用命令快捷按钮
   - 一键使用常见场景命令

## 配置步骤

### 1. 获取 DeepSeek API Key

访问 [DeepSeek 开放平台](https://platform.deepseek.com/api_keys) 注册账号并获取 API Key。

### 2. 配置 API Key

- 在应用主界面点击 ⚙️ AI 设置按钮（位于主题选择器旁边）
- 填写 API Key 和选择模型
- 启用 AI 助手功能
- 点击保存

**配置选项说明：**
- **API Key**: 从 DeepSeek 平台获取的密钥（格式：sk-xxxxxxxx）
- **API 地址**: 默认 `https://api.deepseek.com`，一般不需要修改
- **模型选择**:
  - `deepseek-chat`: 通用对话模型，适合日常命令生成
  - `deepseek-coder`: 代码专用模型，适合复杂脚本生成
- **启用 AI 助手**: 勾选以启用所有 AI 功能

### 3. 开始使用

配置完成后，在服务器详情页的"远程命令行"面板中：

1. 点击"显示 AI 助手"按钮
2. 在输入框中用自然语言描述你的需求
3. 点击"生成命令"，AI 将生成对应的 Shell 命令
4. 支持一键复制生成的命令

## 使用示例

### 场景 1：生成复杂命令

**输入**: "查看占用8080端口的进程"

**AI 生成**: `lsof -ti:8080 | xargs kill -9`

### 场景 2：解释陌生命令

点击任意已执行命令旁的"解释"按钮，AI 将解释该命令的作用。

**示例命令**: `lsof -i :8080`

**AI 解释**:
```
lsof -i :8080

- lsof: list open files（列出打开的文件）
- -i :8080: 筛选占用 8080 端口的网络连接

这个命令用于查看哪个进程占用了 8080 端口。
```

### 场景 3：错误诊断

执行命令出错时，点击"解释"按钮，AI 将分析错误原因并提供解决方案。

**错误示例**:
```
rm: cannot remove '/var/log/app.log': Permission denied
```

**AI 分析**:
```
错误原因：
- 当前用户没有删除该文件的权限

解决方案：
1. 使用 sudo 执行: sudo rm /var/log/app.log
2. 检查文件权限: ls -l /var/log/app.log
3. 切换到 root 用户: su - root
```

## 技术实现

### 新增文件

1. **electron/services/aiService.js** - AI 服务封装
   - DeepSeek API 调用
   - 流式响应处理
   - 命令生成和解释逻辑

2. **src/components/AIConfig.vue** - 配置组件
   - API Key 设置界面
   - 模型选择
   - 启用/禁用 AI 功能

3. **src/components/TerminalPanel.vue** (修改)
   - 集成 AI 助手界面
   - 添加命令解释功能
   - 实现流式响应显示

### 主要特性

- ✅ 流式响应支持（Server-Sent Events）
- ✅ 上下文感知（当前工作目录、历史命令）
- ✅ 错误处理和超时机制
- ✅ API Key 安全存储（electron-store）
- ✅ 一键复制生成的命令
- ✅ 常用命令快捷提示

## 注意事项

1. **API 费用**: DeepSeek API 按 token 计费，请注意使用频率
2. **网络连接**: AI 功能需要联网才能使用
3. **数据安全**: API Key 存储在本地，请妥善保管
4. **默认禁用**: AI 功能默认关闭，需要手动启用

## 故障排除

### 问题：AI 助手无法使用

**原因**: API Key 未配置或无效

**解决方案**:
1. 检查 API Key 是否正确
2. 确认网络连接正常
3. 查看浏览器控制台是否有错误信息

### 问题：流式响应卡顿

**原因**: 网络延迟或 API 响应慢

**解决方案**:
1. 检查网络连接
2. 等待响应完成，不要重复点击

## 未来扩展

可以进一步扩展的功能：

- [ ] AI 代码编辑器（Monaco Editor 集成）
- [ ] 智能同步规则生成
- [ ] 服务器配置诊断
- [ ] 日志分析和错误预测
- [ ] 多语言支持

## 总结

DeepSeek AI 助手的集成为远程服务器管理带来了智能化的体验：

- 降低命令使用门槛，新手也能快速上手
- 提高开发效率，减少查阅文档时间
- 智能错误诊断，快速定位问题
- 流式响应体验，无需等待

配置简单，使用方便，是开发者和运维人员的得力助手！
